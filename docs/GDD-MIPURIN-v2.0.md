# ミプリンの冒険 — 世界リリース品質改修設計書

文書ID: GDD-MIPURIN-v2.0 | 日付: 2026-02-26

## 第1章 現状診断サマリ

### Metacritic換算スコア: 35-40/100

| # | 項目 | スコア/10 |
|---|---|---|
| 1 | コアゲームプレイループ | 4 |
| 2 | メタプログレッション | 3 |
| 3 | ランダム生成・リプレイ性 | 4 |
| 4 | 敵デザイン・AI | 3 |
| 5 | ストーリー・キャラクター | 3 |
| 6 | ビジュアル | 2 |
| 7 | 音響 | 5 |
| 8 | 操作性 | 4 |
| 9 | UI/UX | 3 |
| 10 | 技術品質 | 5 |

### 致命的欠落 TOP 5

1. ラン内ビルドバリエーション皆無
2. メタプログレッション未設計
3. ビジュアルがプレースホルダー
4. 戦闘の手触りが欠如
5. ルート選択・意思決定ポイントが無い

### 目標

| Phase | 目標 | Metacritic |
|---|---|---|
| 1 基盤修正 | 55/100 | やや好評下限 |
| 2 コンテンツ充実 | 70/100 | 好評 |
| 3 ポリッシュ | 80/100 | 非常に好評 |

---

## 第2章 コアゲームプレイループ再設計

### 花園の祝福（Bloom Blessings）システム

6系統の花の精霊が祝福を提供。

| 系統 | 精霊 | テーマ | 色 | 代表効果 |
|---|---|---|---|---|
| 薔薇 | ローザ | 攻撃・クリティカル | 赤 | ATK+40%, クリティカル時HP回復 |
| 百合 | リリア | 防御・バリア | 白 | 被ダメ軽減, シールド生成 |
| 向日葵 | ソーレ | 速度・ダッシュ | 黄 | 速度+30%, ダッシュ後攻撃2倍 |
| 藤 | フジカ | 毒・DoT | 紫 | 攻撃に毒付与, 毒爆発 |
| 蓮 | ハスミ | 回復・持続 | 桃 | 部屋クリア時HP回復, 最大HP増 |
| 菊 | キクネ | ユーティリティ | 金 | ドロップ率UP, EXP UP, 針弾数UP |

各系統13祝福(基本8+レア4+伝説1) = 合計78祝福。

### デュオ祝福（シナジー）

| 組み合わせ | 名前 | 効果 |
|---|---|---|
| 薔薇×藤 | 毒薔薇 | クリティカル時に毒を周囲散布 |
| 百合×蓮 | 不滅の蓮 | HP0で1回だけ全回復復活 |
| 向日葵×薔薇 | 灼熱突撃 | ダッシュ中接触敵に大ダメージ |
| 藤×菊 | 腐食の収穫 | 毒撃破でドロップ率3倍 |
| 蓮×百合 | 生命の壁 | シールドがHP回復量に比例 |
| 向日葵×菊 | 黄金疾走 | 速度上昇中に花粉自動収集 |

全15組。

### 武器システム

| 武器 | 特性 | 特殊 | アンロック |
|---|---|---|---|
| 蜂の針(初期) | 近接連打 | 3連撃 | 初期 |
| 蜜砲 | 遠距離単発 | 貫通 | ボス初回撃破 |
| 花粉盾 | カウンター | パリィ2倍反撃 | 5回クリア |
| 蔦鞭 | 中距離薙ぎ払い | 毒付与 | 藤の祝福10種収集 |
| 羽根手裏剣 | 遠距離連射 | ホーミング | 移動距離10万px |
| 女王の杖 | チャージ魔法 | 範囲爆発 | 全ボス撃破 |

---

## 第3章 メタプログレッション

### 永続通貨: ネクター

- 通常敵撃破: 1
- エリート撃破: 5
- ボス撃破: 20
- 無傷クリアボーナス: 3
- 初クリアボーナス: 50

### 花壇（永続アンロックツリー）

| カテゴリ | 例 | コスト | 効果 |
|---|---|---|---|
| 体力の花壇 | HP+5 (5段) | 10-100 | 永続HP増 |
| 力の花壇 | ATK+1 (5段) | 15-120 | 永続ATK増 |
| 幸運の花壇 | 選択肢+1 (2段) | 50,200 | 3択→5択 |
| 記憶の花壇 | 武器解放 (6種) | 各100 | 新武器 |
| 交流の花壇 | NPC会話 | 各30 | ストーリー |
| 復活の花壇 | デスペナ軽減 | 150 | 死亡時花粉50%保持 |
| 探索の花壇 | ルート拡張 | 200 | 隠し部屋率UP |

死亡時: レベル・装備・祝福リセット。ネクター+花壇永続強化は維持。

---

## 第4章 ダンジョン構造再設計

### ノードマップ方式

| アイコン | 種別 | 頻度 | 内容 |
|---|---|---|---|
| ⚔ | 通常戦闘 | 50% | 敵2-4体, 祝福報酬 |
| 💀 | エリート | 15% | 強敵, レア祝福確定 |
| 🏪 | ショップ | 10% | 花粉で購入 |
| ❓ | イベント | 10% | 選択式テキスト |
| 💎 | 宝箱 | 5% | 装備確定 |
| 🌿 | 休憩 | 5% | HP回復 or 祝福強化 |
| 👑 | ボス | 固定 | 各階層末尾 |

7-10ノード/階層, 2-3分岐, ボス前は収束。

### 部屋テンプレート

開放型, 迷路型, 環状型, L字型, 十字型 × 環境ギミック(トゲ, 水場, 草むら, 爆発樽)。テーマ別: 森→毒沼, 洞窟→落石, 花畑→花粉嵐, 深淵→床消滅。

---

## 第5章 戦闘の手触り（Game Feel）

### ヒットストップ

- 通常命中: 3-5F停止
- クリティカル: 6-8F
- 実装: Engine.hitStopTimer

### スクリーンシェイク

- 通常命中: 3px/100ms
- クリティカル: 6px/150ms
- ボス被弾: 10px/250ms
- ボス撃破: 15px/500ms

### 攻撃テレグラフ

全敵に0.5-1秒の攻撃予告: 赤点滅, 範囲表示, 突進線, チャージ光。

### ノックバック

- プレイヤー被弾: 64px+1秒iフレーム+点滅
- 敵被弾: 16px+0.1秒白フラッシュ
- ダッシュ: 発動中完全無敵+0.2秒延長

### パーティクル強化

| イベント | 効果 | 数 |
|---|---|---|
| 通常命中 | 白斬撃+黄火花 | 5-8 |
| クリティカル | 星型+赤爆発 | 10-15 |
| 敵撃破 | 敵色破片 | 15-20 |
| ダッシュ | 残像3F | 3 |
| 祝福獲得 | 花びら | 20-30 |

---

## 第6章 敵デザイン

### 設計原則

全敵に必須: テレグラフ(予告), パターン(学習可能), 対処法(明確)。

### ティア分類

| ティア | 出現 | 特徴 |
|---|---|---|
| T1雑魚 | 全域 | 低HP, 単純パターン |
| T2中堅 | エリア2+ | 複合パターン |
| T3精鋭 | エリア3+ | 複数フェーズ |
| ボス | 各末尾 | 3フェーズ, 弾幕 |

### ボス: 腐敗の大樹（エリア1）

- Phase 1: 根っこ攻撃(赤マーカー予告)
- Phase 2(HP66%): 毒の実+根
- Phase 3(HP33%): 本体追尾+根+実+胞子
- 弱点: 花の部分(上部)でダメージ2倍

---

## 第7章 ビジュアル改修

- 段階1: シルエット+カラー改善(即時)
- 段階2: AI生成ピクセルアート(sprite-generator-v4活用)
- 段階3: 手動修正+アニメーション洗練

---

## 第8章 ストーリー・ナラティブ

- 死のループの物語的理由: 花の精霊の力で蘇る設定
- ラン回数に応じたNPC会話変化(10-15段階/NPC)
- コレクション図鑑にLoreテキスト紐付け
- 図鑑完成度で隠しエンディング解放

---

## 第9章 UI/UX改修

### HUDレイアウト

- 左上: HP, 針, 祝福アイコン
- 右上: 階層, 部屋数, 花粉
- 左下: ミニマップ
- 右下: ドロップログ

全UI画面をuiHelper.js統一。シーン遷移にフェード。

---

## 第10章 実装ロードマップ

### Phase 1 (6週) → 55/100

- W1: 戦闘手触り(ヒットストップ, シェイク, パーティクル)
- W2: 祝福システム(24祝福+選択UI)
- W3: ノードマップ(生成+UI+遷移)
- W4: メタプログレッション(ネクター+花壇+死亡フロー)
- W5: 敵AIリファクタ(テレグラフ+パターン)
- W6: UI統一(HUD+CONFIG基準レイアウト)

### Phase 2 (6週) → 70/100

- W7-8: 残り祝福54種+デュオ15種
- W9: 武器4種追加
- W10: ボス4体
- W11: AIスプライト投入
- W12: NPC会話+図鑑Lore

### Phase 3 (4週) → 80/100

- W13: BGM 8曲+SE全種
- W14: スプライトクリーンアップ
- W15: バランス調整
- W16: QA

### Phase 3後スコア

| # | 項目 | 現在→後 |
|---|---|---|
| 1 | コアループ | 4→8 |
| 2 | メタ | 3→7 |
| 3 | ランダム生成 | 4→7 |
| 4 | 敵デザイン | 3→7 |
| 5 | ストーリー | 3→5 |
| 6 | ビジュアル | 2→7 |
| 7 | 音響 | 5→7 |
| 8 | 操作性 | 4→7 |
| 9 | UI | 3→7 |
| 10 | 技術 | 5→7 |

加重113/170 = 66.5% → Metacritic 72-75

---

## 第11章 新規ファイル一覧 (14本)

blessings.js, blessingUI.js, weapons.js, meta.js, metaUI.js, nodeMap.js, nodeMapUI.js, roomTemplates.js, events.js, gameFeel.js, damageNumber.js, enemyAI.js, hud.js, minimap.js
